# Пример: Правильное применение принципа инверсии зависимостей (DIP)

## Описание

Данный пример демонстрирует **правильное применение принципа инверсии зависимостей (DIP)** - все зависимости направлены к абстракциям, нет проверки конкретных типов.

## Суть примера

В отличие от примера `18_Dip`, где `ItemCoffe` использовал `dynamic_cast` для проверки конкретного типа, здесь:

### Абстракции для поиска
```cpp
class ISearchItem {
    virtual bool isCookie();
    virtual bool accept(IItem*);
};

class ISearchInterface {
    virtual bool SearchMenu(ISearchItem *item) = 0;
};
```

### Использование абстракций
```cpp
class ItemCoffe : public IItem {
    void print(ISearchInterface *search) override {
        // Использует абстракцию, а не конкретный тип
        if (search->SearchMenu(this))
            std::cout << " for your cookie";
    }
};
```

### Реализация поиска
```cpp
class Menu : public ISearchInterface {
    bool SearchMenu(ISearchItem *item) override {
        // Использует метод accept() вместо проверки типов
        if (item->accept(i.get())) return true;
    }
};
```

## Принцип DIP

**Модули высокого уровня не должны зависеть от модулей низкого уровня. Оба должны зависеть от абстракций.**

Решение:
- **Абстракции для поведения** - `ISearchItem` и `ISearchInterface` определяют контракт
- **Полиморфизм вместо проверки типов** - используется `accept()` вместо `dynamic_cast`
- **Инверсия зависимостей** - все зависимости направлены к абстракциям

## Преимущества

- **Слабая связанность** - классы не знают о конкретных типах
- **Расширяемость** - можно добавить новые типы без изменения существующего кода
- **Соблюдение OCP** - открыт для расширения, закрыт для модификации
- **Тестируемость** - легко создать mock-объекты для тестирования

## Сравнение с `18_Dip`

- `18_Dip`: `ItemCoffe` использует `dynamic_cast<ItemBulka>` - зависимость от конкретного типа
- `19_Dip`: `ItemCoffe` использует `ISearchInterface` - зависимость от абстракции

## Паттерн Visitor

Пример также демонстрирует элементы паттерна **Visitor**:
- `accept()` - метод принятия посетителя
- `SearchMenu()` - операция посетителя
- Полиморфизм для обработки разных типов

